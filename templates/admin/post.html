<!DOCTYPE html>
{% load staticfiles %}
<html lang="en">
<head>
    <title>{{post.title}}</title>
    <style>
     body{
      background-image: url(/static/home.jpg);
      background-position: center center;
      background-repeat: no-repeat;
      background-attachment: fixed;
      background-size: cover;
      background-color: #FFC0CB;
    }
    #map {
        height: 400px;
        width: 100%;
    }
    </style>
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
</head>

<body class="container" style="min-width: 970px;">
    <nav class="navbar navbar-default" style="min-width: 1140px;">
         <div class="col-md-3">
            <img height="60" src="{% static "1.jpg" %}" />
         </div>
        <div class="col-md-7">
            <h1><p>{{post.title}}</p></h1>
        </div>
    </nav>



   <div class="row">
           <div class="col-md-9">
               {% if post.published_date %}
               <div class="date">
                   {{ post.published_date }}
               </div>
               {% endif %}
               <h1>{{ post.title }}</h1>
               <p>{{ post.text|linebreaksbr }}</p>
               <hr>
               <div class="row">
                    <div class="col-md-6">
                        {% load static %}
                        <img src="{% get_media_prefix %}{{ post.img.name }}" class="img-responsive img-rounded">
                    </div>
                   <div class="col-md-6">
                       <div id="map"></div>
                   </div>
               </div>
           </div>

        <script>
          function initMap() {
            var uluru = {lat: {{post.latitude}}, lng: {{post.longitude}} };
            var map = new google.maps.Map(document.getElementById('map'), {
              zoom: 4,
              center: uluru
            });
            var marker = new google.maps.Marker({
              position: uluru,
              map: map,
                draggable: true,
            });
            document.getElementById('id_latitude').value = marker.getPosition().lat();
            document.getElementById('id_longitude').value = marker.getPosition().lng();
             marker.addListener('dragend', function() {
              document.getElementById('id_latitude').value = marker.getPosition().lat();
                document.getElementById('id_longitude').value = marker.getPosition().lng();
            });
          }
        </script>

       <script async defer
               src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCSgKuqkhenn3A8URWybahP--T0rENyeO0&callback=initMap">
       </script>

       <hr>
       <div class="col-md-9">
           <p class="lead">
               Likes: {{post.rating.likes}}</p>
           <p class="lead">
               Dislikes: {{post.rating.dislikes}}</p>

           <form method='POST'>
        {% csrf_token %}
        <button type="submit" name="like_button">Like</button>
        <button type="submit" name="dislike_button">Dislike</button>
    </form>
    <hr>
    {% for comment in post.comment_set.all %}
    <p class="lead">
        {{comment.author}} commented at {{comment.published_date}}</p>
    <p>{{comment.text|linebreaksbr}}</p>
           <br>
    {% endfor %}

    <form method="post">
        <div class="col-md-9">
            {% csrf_token %}
            {% for error in form.non_field_errors %}
            <div><strong>Ошибка!</strong> {{ error }}</div>
            {% endfor %}
            {% for input in form.visible_fields %}
            <div class="form-group">
                <label for="{{ input.name }}">{{ input.label }}</label>
                {{input}}
            </div>
            {% endfor %}
            <button type="submit" class="btn btn-default">Comment</button>
        </div>
    </form>
       </div>

</body>
</html>