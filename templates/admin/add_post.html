<!DOCTYPE html>
{% load staticfiles %}
<html lang="en">
<head>
    <title>Add new post</title>
    <style>
     body{
      background-image: url(/static/home.jpg);
      background-position: center center;
      background-repeat: no-repeat;
      background-attachment: fixed;
      background-size: cover;
      background-color: #FFC0CB;
    }
    #map {
        height: 400px;
        width: 100%;
    }
    </style>
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
</head>

<body class="container" style="min-width: 970px;">
    <nav class="navbar navbar-default" style="min-width: 1140px;">
         <div class="col-md-3">
            <img height="60" src="{% static "1.jpg" %}" />
         </div>
        <div class="col-md-7">
            <h1><p>Blog for travelers</p></h1>
        </div>
        <div class="col-md-2">
            <a href="{% url 'home' %}"><button type="button" class="btn btn-default navbar-btn">return</button></a>
        </div>
    </nav>

   <div class="row">
       <form method="post" id="form" enctype="multipart/form-data">
           <div class="col-md-9">
               <h1><p>Add new post</p></h1>
               {% csrf_token %}
               {% for error in form.non_field_errors %}
               		<div><strong>Ошибка!</strong> {{ error }}</div>
               {% endfor %}
               {% for input in form.visible_fields %}
               <div class="form-group">
                   <h3><em><label for="{{ input.name }}">{{ input.label }}</label></em></h3>
                   {{input}}
               </div>
               {% endfor %}
                {% for hidden in form.hidden_fields %}
                    {{ hidden }}
                {% endfor %}
               {% if messages %}
                    <ul class="messages">
                    {% for message in messages %}
                        <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
                    {% endfor %}
                    </ul>
                {% endif %}
                <div id="map"></div>
               <button type="submit" class="btn btn-default" >Add</button>
           </div>
        </form>

        <script>
          function initMap() {
            var uluru = {lat: 0, lng: 0};
            var places = 3;
            var map = new google.maps.Map(document.getElementById('map'), {
              zoom: 4,
              center: uluru
            });

            var marker = new google.maps.Marker({
                              position: uluru,
                              map: map,
                                draggable: true,
                            });
                document.getElementById('id_latitude').value = marker.getPosition().lat();
                document.getElementById('id_longitude').value = marker.getPosition().lng();
                marker.addListener('dragend', function() {
                    document.getElementById('id_latitude').value = marker.getPosition().lat();
                    document.getElementById('id_longitude').value = marker.getPosition().lng();
                });

            var marker2 = new google.maps.Marker({
                              position: uluru,
                              map: map,
                                draggable: true,
                            });
                document.getElementById('id_latitude2').value = marker2.getPosition().lat();
                document.getElementById('id_longitude2').value = marker2.getPosition().lng();
                marker2.addListener('dragend', function() {
                    document.getElementById('id_latitude2').value = marker2.getPosition().lat();
                    document.getElementById('id_longitude2').value = marker2.getPosition().lng();
                });

             var marker3 = new google.maps.Marker({
                              position: uluru,
                              map: map,
                                draggable: true,
                            });
                document.getElementById('id_latitude3').value = marker3.getPosition().lat();
                document.getElementById('id_longitude3').value = marker3.getPosition().lng();
                marker3.addListener('dragend', function() {
                    document.getElementById('id_latitude3').value = marker3.getPosition().lat();
                    document.getElementById('id_longitude3').value = marker3.getPosition().lng();
                });

/*
for (i = 0; i < 10; i++) {

    markers[i] = new google.maps.Marker({
        position: new google.maps.LatLng(40+Math.random()*5, 4+Math.random()*5),
        map: map,
        title: 'samplemarker'
    });

    markers[i].index = i; //add index property
    contents[i] = '<div class="popup_container"></div>';


    infowindows[i] = new google.maps.InfoWindow({
        content: contents[i],
        maxWidth: 300
    });

    google.maps.event.addListener(markers[i], 'click', function() {
        console.log(this.index); // this will give correct index
        console.log(i); //this will always give 10 for you
        infowindows[this.index].open(map,markers[this.index]);
        map.panTo(markers[this.index].getPosition());
    });
}
*/
          }
        </script>

        <script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCSgKuqkhenn3A8URWybahP--T0rENyeO0&callback=initMap">
        </script>

    </div>
</body>
</html>
